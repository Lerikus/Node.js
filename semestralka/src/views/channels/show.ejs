<div class="channel-layout">
  <div class="channel-sidebar">
    <h2>Channels</h2>
    <ul class="channel-list">
      <% channels.forEach(chan => { %>
        <li class="channel-list-item">
          <a href="/channels/<%= chan.id %>" class="<%= channel.id === chan.id ? 'active' : '' %>">
            <div style="display: flex; align-items: center;">
              <span style="margin-right: 5px;">#</span>
              <span><%= chan.name %></span>
            </div>
          </a>
        </li>
      <% }); %>
    </ul>
    
    <a href="/channels/new" class="add-channel-btn">
      <div style="display: flex; align-items: center;">
        <span style="margin-right: 5px; font-weight: bold;">+</span>
        <span>Add Channel</span>
      </div>
    </a>
  </div>
  
  <div class="channel-content">
    <% if (isChannelList && locals.allChannels && allChannels.length > 1) { %>
      <!-- Channel List Overview (shown only on /channels) -->
      <div style="padding: 20px; background-color: white; height: 100%; overflow-y: auto;">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px;">
          <h2>All Channels</h2>
          <a href="/channels/new" style="background-color: #4A154B; color: white; padding: 8px 16px; text-decoration: none; border-radius: 4px;">Create Channel</a>
        </div>
        
        <div>
          <% allChannels.forEach(chan => { %>
            <a href="/channels/<%= chan.id %>" style="text-decoration: none; color: inherit; display: block;">
              <div style="background-color: #f8f8f8; border-radius: 6px; padding: 15px; margin-bottom: 15px; border: 1px solid #eee; transition: all 0.2s ease; cursor: pointer;" 
                   onmouseover="this.style.backgroundColor='#f0f0f0'; this.style.boxShadow='0 2px 5px rgba(0,0,0,0.1)';" 
                   onmouseout="this.style.backgroundColor='#f8f8f8'; this.style.boxShadow='none';">
                <h3 style="margin-top: 0; margin-bottom: 8px; color: #1D1C1D;">
                  # <%= chan.name %>
                </h3>
                <% if (chan.description) { %>
                  <p style="color: #616061; margin-bottom: 10px;"><%= chan.description %></p>
                <% } else { %>
                  <p style="color: #616061; margin-bottom: 10px;"><em>No description</em></p>
                <% } %>
                <div style="color: #616061; font-size: 0.9rem;">
                  Created by <%= chan.createdByName %> on <%= new Date(chan.createdAt).toLocaleDateString() %>
                </div>
              </div>
            </a>
          <% }); %>
        </div>
      </div>
    <% } else { %>
      <!-- Simplified Channel Messages View -->
      <div class="container">
        <div class="channel-header">
          <h1><%= channel.name %></h1>
          <p><%= channel.description %></p>
          
          <% if (user.id === channel.createdBy) { %>
            <div class="channel-actions">
              <a href="/channels/<%= channel.id %>/edit" class="btn btn-secondary">Edit Channel</a>
              <form action="/channels/<%= channel.id %>/delete" method="POST" class="inline-form">
                <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to delete this channel?')">Delete Channel</button>
              </form>
            </div>
          <% } %>
        </div>
        
        <div class="chat-container">
          <div id="messages-container" class="messages-container">
            <!-- Messages will be loaded here -->
          </div>
          
          <form id="message-form" class="message-form">
            <input type="hidden" id="channel-id" value="<%= channel.id %>">
            <input type="hidden" id="user-id" value="<%= user.id %>">
            <input type="text" id="message-input" placeholder="Type a message..." autocomplete="off">
            <button type="submit">Send</button>
          </form>
        </div>
      </div>

      <script src="/static/js/chat.js"></script>
    <% } %>
  </div>
</div>
